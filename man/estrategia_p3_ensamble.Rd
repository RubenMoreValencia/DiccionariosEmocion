% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analisis_emociones.R
\name{estrategia_p3_ensamble}
\alias{estrategia_p3_ensamble}
\title{Ensamble robusto de métodos de sentimiento sobre una escala de referencia}
\usage{
estrategia_p3_ensamble(
  df,
  method_cols,
  ref,
  out_dir = NULL,
  robust = c("auto", "rq", "rlm", "mblm"),
  n_switch = 1000L,
  sample_for_plots = 2000L,
  seed = 1L,
  percentiles = c(0.25, 0.5, 0.75)
)
}
\arguments{
\item{df}{data.frame con columnas de métodos numéricas y (opcional) identificadores.}

\item{method_cols}{character, nombres de columnas de métodos (incluye \code{ref}).}

\item{ref}{character, nombre del método de referencia (debe estar en \code{method_cols}).}

\item{out_dir}{character, carpeta para guardar PNG (si existe); si \code{NULL}, no guarda.}

\item{robust}{"auto"|"rq"|"rlm"|"mblm". En "auto": usa "rq" si \code{n >= n_switch}, si no "rlm".}

\item{n_switch}{integer, umbral de n para usar \code{rq} en modo "auto".}

\item{sample_for_plots}{integer o \code{NULL}. Si no \code{NULL}, tamaño de muestra para gráficos.}

\item{seed}{integer o \code{NULL}. Semilla para muestrear gráficos.}

\item{percentiles}{numeric en \code{[0,1]}, p.ej. \code{c(0.25,0.5,0.75)} para categorizar el ensamble.}

\item{"rq"}{(auto) TODO: describir parámetro.}

\item{"rlm"}{(auto) TODO: describir parámetro.}

\item{"mblm"}{(auto) TODO: describir parámetro.}
}
\value{
list con:
\itemize{
\item \code{data}: \code{df} con columnas \code{sent_compuesto} y \code{Nivel_sent_compuesto}.
\item \code{calibracion}: data.frame con \code{metodo}, \code{a0}, \code{b1}, \code{R2}, \code{CCC}.
\item \code{pesos}: data.frame con \code{metodo}, \code{peso} (normalizados a 1).
\item \code{alpha}: intercepto global del ensamble (0; se absorbe por-método en proyección).
\item \code{graficos}: lista de ggplots (\code{pesos}, \code{densidad_ensamble}, \code{scatter_ref_vs_metodo}).
\item \code{auditoria}: lista con \code{n}, \code{robust_final}, \code{muestra_graficos}, \code{tiempos}.
}
}
\description{
Calibra métodos \code{method_cols} hacia la escala del método \code{ref}
mediante regresión robusta (\code{rq} si \code{robust="rq"} o si \code{n >= n_switch},
\code{rlm} si \code{robust="rlm"}, \code{mblm} si \code{robust="mblm"}).
Proyecta cada método a la escala del ref y calcula un índice compuesto ponderando
por la concordancia de Lin (CCC). Devuelve tabla con resultados, calibración, pesos,
y gráficos diagnósticos (opcionalmente muestreados para ser livianos).
}
\seealso{
Other utilidades: 
\code{\link{DividirPorPercentiles}()},
\code{\link{GenerarDataframeT}()},
\code{\link{LimpiaTexto}()},
\code{\link{TabContingencia_MaxMinXFila}()},
\code{\link{TraduceA}()},
\code{\link{UnirExcelITFF_Optimizada}()},
\code{\link{agregar_recuento_filas}()},
\code{\link{agrupar_emociones}()},
\code{\link{ajustar_gradient_boosting}()},
\code{\link{ajustar_red_nn_unificada}()},
\code{\link{ajustar_regresion_multinomial}()},
\code{\link{ajustar_rnn_regresion}()},
\code{\link{ajustar_rnn_regresion_torch}()},
\code{\link{analizar_coherencia_metodos}()},
\code{\link{analizar_comentarios}()},
\code{\link{analizar_comentarios_ReEscalado}()},
\code{\link{analizar_comentarios_ReEscalado_general}()},
\code{\link{analizar_comentarios_ReEscalado_v3}()},
\code{\link{analizar_comentarios_XP}()},
\code{\link{analizar_consistencia_lexicos}()},
\code{\link{analizar_consistencia_lexicos_v2}()},
\code{\link{analizar_correlaciones_metodos}()},
\code{\link{analizar_emociones_texto}()},
\code{\link{analizar_percentiles_columna}()},
\code{\link{analizar_percentiles_columnaBinaria}()},
\code{\link{analizar_tokens_extremos}()},
\code{\link{anotar_tokens_idioma_simple}()},
\code{\link{as_df_safe}()},
\code{\link{build_emotion_indices}()},
\code{\link{calcular_ensamble_ponderado}()},
\code{\link{calcular_puntaje_emocional}()},
\code{\link{calibrar_metodo_referencia}()},
\code{\link{cambiar_nombres_columnas}()},
\code{\link{categorizar_indices}()},
\code{\link{categorizar_por_percentiles}()},
\code{\link{categorizar_por_percentiles_full}()},
\code{\link{cluster_emotion_spaces}()},
\code{\link{cluster_hclust_cut}()},
\code{\link{cluster_kmeans_auto}()},
\code{\link{configurar_openai_clave}()},
\code{\link{convertir_a_factores_arbol}()},
\code{\link{crear_diccionario_emociones}()},
\code{\link{eliminar_filas_repetidas}()},
\code{\link{eliminarduplicados}()},
\code{\link{emocion_mas_fuerte}()},
\code{\link{estrategia_p1_preparacion}()},
\code{\link{estrategia_p5_clusters}()},
\code{\link{extraer_features_emocionales}()},
\code{\link{filtrar_diccionario}()},
\code{\link{generar_reporte_html}()},
\code{\link{guardarDataFrameCSV}()},
\code{\link{interseccionDataFrames}()},
\code{\link{leerCSVConNombres}()},
\code{\link{mostrar_diccionario_emociones}()},
\code{\link{p7_exportar_reporte_maestro}()},
\code{\link{pipeline_emociones}()},
\code{\link{predecir_nivel_bin}()},
\code{\link{procesar_emociones_comentarios}()},
\code{\link{run_fa}()},
\code{\link{safe_write_csv}()},
\code{\link{segmentar_consistencia_lexicos}()},
\code{\link{simular_arbol}()},
\code{\link{simular_comparacion_todos}()},
\code{\link{simular_random_forest}()},
\code{\link{simular_red_neuronal}()},
\code{\link{simular_red_nn_unificada}()},
\code{\link{simular_regresion}()},
\code{\link{simular_regresion_multinomial}()},
\code{\link{simular_rnn_regresion}()},
\code{\link{simular_rnn_regresion_torch}()},
\code{\link{sp_save}()},
\code{\link{summarize_emotion_space}()},
\code{\link{vector_a_cadena}()},
\code{\link{verificar_clave_openai}()}
}
\concept{utilidades}
